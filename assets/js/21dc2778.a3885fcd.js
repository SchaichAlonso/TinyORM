"use strict";(self.webpackChunktinyorm_org=self.webpackChunktinyorm_org||[]).push([[291],{5162:function(e,t,n){n.d(t,{Z:function(){return o}});var a=n(7294),i=n(6010),l="tabItem_Ymn6";function o(e){var t=e.children,n=e.hidden,o=e.className;return a.createElement("div",{role:"tabpanel",className:(0,i.Z)(l,o),hidden:n},t)}},5488:function(e,t,n){n.d(t,{Z:function(){return c}});var a=n(7462),i=n(7294),l=n(6010),o=n(2389),r=n(7392),m=n(7094),d=n(2466),p="tabList__CuJ",s="tabItem_LNqP";function u(e){var t,n,o=e.lazy,u=e.block,c=e.defaultValue,h=e.values,k=e.groupId,g=e.className,N=i.Children.map(e.children,(function(e){if((0,i.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),b=null!=h?h:N.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),v=(0,r.l)(b,(function(e,t){return e.value===t.value}));if(v.length>0)throw new Error('Docusaurus error: Duplicate values "'+v.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var f=null===c?c:null!=(t=null!=c?c:null==(n=N.find((function(e){return e.props.default})))?void 0:n.props.value)?t:N[0].props.value;if(null!==f&&!b.some((function(e){return e.value===f})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+f+'" but none of its children has the corresponding value. Available values are: '+b.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var y=(0,m.U)(),C=y.tabGroupChoices,T=y.setTabGroupChoices,w=(0,i.useState)(f),I=w[0],x=w[1],M=[],S=(0,d.o5)().blockElementScrollPositionUntilNextRender;if(null!=k){var E=C[k];null!=E&&E!==I&&b.some((function(e){return e.value===E}))&&x(E)}var D=function(e){var t=e.currentTarget,n=M.indexOf(t),a=b[n].value;a!==I&&(S(t),x(a),null!=k&&T(k,String(a)))},A=function(e){var t,n=null;switch(e.key){case"ArrowRight":var a,i=M.indexOf(e.currentTarget)+1;n=null!=(a=M[i])?a:M[0];break;case"ArrowLeft":var l,o=M.indexOf(e.currentTarget)-1;n=null!=(l=M[o])?l:M[M.length-1]}null==(t=n)||t.focus()};return i.createElement("div",{className:(0,l.Z)("tabs-container",p)},i.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":u},g)},b.map((function(e){var t=e.value,n=e.label,o=e.attributes;return i.createElement("li",(0,a.Z)({role:"tab",tabIndex:I===t?0:-1,"aria-selected":I===t,key:t,ref:function(e){return M.push(e)},onKeyDown:A,onFocus:D,onClick:D},o,{className:(0,l.Z)("tabs__item",s,null==o?void 0:o.className,{"tabs__item--active":I===t})}),null!=n?n:t)}))),o?(0,i.cloneElement)(N.filter((function(e){return e.props.value===I}))[0],{className:"margin-top--md"}):i.createElement("div",{className:"margin-top--md"},N.map((function(e,t){return(0,i.cloneElement)(e,{key:t,hidden:e.props.value!==I})}))))}function c(e){var t=(0,o.Z)();return i.createElement(u,(0,a.Z)({key:String(t)},e))}},5178:function(e,t,n){n.d(t,{Z:function(){return r}});var a=n(7294),i=n(6775),l="apiTable_flxF";var o=(0,a.forwardRef)((function(e,t){var n=e.name,l=e.children,o=function(e){for(var t=e;(0,a.isValidElement)(t);)t=a.Children.toArray(t.props.children)[0];return t}(l),r=n?"#"+n+"-"+o:"#"+o,m=(0,i.k6)();return a.createElement("tr",{id:o,tabIndex:0,ref:m.location.hash===r?t:void 0,onClick:function(){m.push(r)},onKeyDown:function(e){"Enter"===e.key&&m.push(r)}},l.props.children)}));function r(e){var t=e.children,n=e.name,i=a.Children.toArray(t.props.children),r=i[0],m=i[1],d=(0,a.useRef)(null);(0,a.useEffect)((function(){var e;null==(e=d.current)||e.focus()}),[d]);var p=a.Children.map(m.props.children,(function(e){return a.createElement(o,{name:n,ref:d},e)}));return a.createElement("table",{className:l},r,a.createElement("tbody",null,p))}},2044:function(e,t,n){n.d(t,{C:function(){return m},Fo:function(){return o},IM:function(){return d},IZ:function(){return a},RS:function(){return u},al:function(){return s},jk:function(){return r},q5:function(){return l},qb:function(){return p},wU:function(){return i}});var a="shell",i="application",l="bash",o="pwsh",r="application",m="bash",d="pwsh",p="TestApp",s="$HOME/Code/c/",u="$env:USERPROFILE\\Code\\c\\"},4355:function(e,t,n){n.d(t,{Z:function(){return l}});var a=n(7294),i=n(9482);function l(){var e=(0,a.useContext)(i.Z);if(null!=e)return e;throw new Error("useRootFolderContext is used outside of Layout component.")}},6005:function(e,t,n){n.d(t,{AE:function(){return r},EA:function(){return o},em:function(){return d},go:function(){return m},mT:function(){return p},we:function(){return s}});var a=n(4355),i=n(2389),l=n(2044),o=function(e,t){var n;return void 0===t&&(t=!0),u(null!=(n=(0,a.Z)().rootFolder[e])?n:d(e),e,t)},r=function(){var e;return null!=(e=(0,a.Z)().rootFolder[l.wU])?e:d(l.wU)},m=function(e,t){if(void 0===t&&(t=!0),null==e)throw new Error("The groupId in the applicationFolderPath() can not be empty.");var n=t||e!==l.Fo?"/":"\\";return u(o(e)+n+r(),e,t)};function d(e){if(null==e)throw new Error("The groupId in the folderDefaultValue() can not be empty.");if(!(0,i.Z)())return"";switch(e){case l.Fo:return l.RS;case l.q5:return l.al;case l.wU:return l.qb;default:throw new Error("No default value for '"+e+"' groupId in the folderDefaultValue().")}}function p(e){return e===l.wU}function s(e,t){if(null==t||""===t)return t;var n="$ENV{$1}$2";switch(e){case l.Fo:return h(t).replace(/\$env:(.+?)(\/.*)/,n);case l.q5:return t.replace(/\$(.+?)(\/.*)/,n);default:throw new Error("Unsupported shell type '"+e+"' in the convertToCmakeEnvVariable().")}}function u(e,t,n){if(void 0===n&&(n=!0),null==e||""===e)return e;if(t!==l.Fo)return c(e);var a=c(e);return n?h(a):function(e){return null==e||""===e?e:e.replaceAll(/\/+/g,"\\")}(a)}function c(e){return null==e||""===e?e:e.replace(/[/\\]+$/,"")}function h(e){return null==e||""===e?e:e.replaceAll(/\\+(?! )/g,"/")}},6122:function(e,t,n){n.r(t),n.d(t,{assets:function(){return g},contentTitle:function(){return h},default:function(){return v},frontMatter:function(){return c},metadata:function(){return k},toc:function(){return N}});var a=n(7462),i=n(3366),l=(n(7294),n(3905)),o=n(5178),r=n(6852),m=n(5162),d=n(5488),p=n(2044),s=n(6005),u=["components"],c={sidebar_position:2,sidebar_label:"Migrations",description:"Migrations are like version control for your database, allowing your team to define and share the application's database schema definition. Migrations use the Schema facade that provides database agnostic support for creating and manipulating tables across all of TinyORM's supported database systems.",keywords:["c++ orm","database","migrations","tinyorm"]},h="Database: Migrations",k={unversionedId:"database/migrations",id:"database/migrations",title:"Database: Migrations",description:"Migrations are like version control for your database, allowing your team to define and share the application's database schema definition. Migrations use the Schema facade that provides database agnostic support for creating and manipulating tables across all of TinyORM's supported database systems.",source:"@site/docs/database/migrations.mdx",sourceDirName:"database",slug:"/database/migrations",permalink:"/database/migrations",draft:!1,editUrl:"https://github.com/silverqx/TinyORM-github.io/edit/main/docs/database/migrations.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,sidebar_label:"Migrations",description:"Migrations are like version control for your database, allowing your team to define and share the application's database schema definition. Migrations use the Schema facade that provides database agnostic support for creating and manipulating tables across all of TinyORM's supported database systems.",keywords:["c++ orm","database","migrations","tinyorm"]},sidebar:"tinyormSidebar",previous:{title:"Query Builder",permalink:"/database/query-builder"},next:{title:"Seeding",permalink:"/database/seeding"}},g={},N=[{value:"Introduction",id:"introduction",level:2},{value:"Generating Migrations",id:"generating-migrations",level:2},{value:"Migrations naming rules",id:"migrations-naming-rules",level:4},{value:"Tab completion",id:"tab-completion",level:2},{value:"Migration Structure",id:"migration-structure",level:2},{value:"Setting The Migration Connection",id:"setting-the-migration-connection",level:4},{value:"Running Migrations",id:"running-migrations",level:2},{value:"Forcing Migrations To Run In Production",id:"forcing-migrations-to-run-in-production",level:4},{value:"Rolling Back Migrations",id:"rolling-back-migrations",level:3},{value:"Roll Back &amp; Migrate Using A Single Command",id:"roll-back--migrate-using-a-single-command",level:4},{value:"Drop All Tables &amp; Migrate",id:"drop-all-tables--migrate",level:4},{value:"Tables",id:"tables",level:2},{value:"Creating Tables",id:"creating-tables",level:3},{value:"Checking For Table / Column Existence",id:"checking-for-table--column-existence",level:4},{value:"Database Connection &amp; Table Options",id:"database-connection--table-options",level:4},{value:"Updating Tables",id:"updating-tables",level:3},{value:"Renaming / Dropping Tables",id:"renaming-and-dropping-tables",level:3},{value:"Renaming Tables With Foreign Keys",id:"renaming-tables-with-foreign-keys",level:4},{value:"Columns",id:"columns",level:2},{value:"Creating Columns",id:"creating-columns",level:3},{value:"Available Column Types",id:"available-column-types",level:3},{value:"<code>bigIncrements()</code>",id:"column-method-bigIncrements",level:4},{value:"<code>bigInteger()</code>",id:"column-method-bigInteger",level:4},{value:"<code>binary()</code>",id:"column-method-binary",level:4},{value:"<code>boolean()</code>",id:"column-method-boolean",level:4},{value:"<code>Char()</code>",id:"column-method-Char",level:4},{value:"<code>dateTimeTz()</code>",id:"column-method-dateTimeTz",level:4},{value:"<code>dateTime()</code>",id:"column-method-dateTime",level:4},{value:"<code>date()</code>",id:"column-method-date",level:4},{value:"<code>decimal()</code>",id:"column-method-decimal",level:4},{value:"<code>Double()</code>",id:"column-method-Double",level:4},{value:"<code>Enum()</code>",id:"column-method-Enum",level:4},{value:"<code>Float()</code>",id:"column-method-Float",level:4},{value:"<code>foreignId()</code>",id:"column-method-foreignId",level:4},{value:"<code>foreignIdFor()</code>",id:"column-method-foreignIdFor",level:4},{value:"<code>foreignUuid()</code>",id:"column-method-foreignUuid",level:4},{value:"<code>geometryCollection()</code>",id:"column-method-geometryCollection",level:4},{value:"<code>geometry()</code>",id:"column-method-geometry",level:4},{value:"<code>id()</code>",id:"column-method-id",level:4},{value:"<code>increments()</code>",id:"column-method-increments",level:4},{value:"<code>integer()</code>",id:"column-method-integer",level:4},{value:"<code>ipAddress()</code>",id:"column-method-ipAddress",level:4},{value:"<code>json()</code>",id:"column-method-json",level:4},{value:"<code>jsonb()</code>",id:"column-method-jsonb",level:4},{value:"<code>lineString()</code>",id:"column-method-lineString",level:4},{value:"<code>longText()</code>",id:"column-method-longText",level:4},{value:"<code>macAddress()</code>",id:"column-method-macAddress",level:4},{value:"<code>mediumIncrements()</code>",id:"column-method-mediumIncrements",level:4},{value:"<code>mediumInteger()</code>",id:"column-method-mediumInteger",level:4},{value:"<code>mediumText()</code>",id:"column-method-mediumText",level:4},{value:"<code>multiLineString()</code>",id:"column-method-multiLineString",level:4},{value:"<code>multiPoint()</code>",id:"column-method-multiPoint",level:4},{value:"<code>multiPolygon()</code>",id:"column-method-multiPolygon",level:4},{value:"<code>point()</code>",id:"column-method-point",level:4},{value:"<code>polygon()</code>",id:"column-method-polygon",level:4},{value:"<code>rememberToken()</code>",id:"column-method-rememberToken",level:4},{value:"<code>set()</code>",id:"column-method-set",level:4},{value:"<code>smallIncrements()</code>",id:"column-method-smallIncrements",level:4},{value:"<code>smallInteger()</code>",id:"column-method-smallInteger",level:4},{value:"<code>string()</code>",id:"column-method-string",level:4},{value:"<code>text()</code>",id:"column-method-text",level:4},{value:"<code>timeTz()</code>",id:"column-method-timeTz",level:4},{value:"<code>time()</code>",id:"column-method-time",level:4},{value:"<code>timestampTz()</code>",id:"column-method-timestampTz",level:4},{value:"<code>timestamp()</code>",id:"column-method-timestamp",level:4},{value:"<code>timestampsTz()</code>",id:"column-method-timestampsTz",level:4},{value:"<code>timestamps()</code>",id:"column-method-timestamps",level:4},{value:"<code>tinyIncrements()</code>",id:"column-method-tinyIncrements",level:4},{value:"<code>tinyInteger()</code>",id:"column-method-tinyInteger",level:4},{value:"<code>tinyText()</code>",id:"column-method-tinyText",level:4},{value:"<code>unsignedBigInteger()</code>",id:"column-method-unsignedBigInteger",level:4},{value:"<code>unsignedDecimal()</code>",id:"column-method-unsignedDecimal",level:4},{value:"<code>unsignedInteger()</code>",id:"column-method-unsignedInteger",level:4},{value:"<code>unsignedMediumInteger()</code>",id:"column-method-unsignedMediumInteger",level:4},{value:"<code>unsignedSmallInteger()</code>",id:"column-method-unsignedSmallInteger",level:4},{value:"<code>unsignedTinyInteger()</code>",id:"column-method-unsignedTinyInteger",level:4},{value:"<code>uuid()</code>",id:"column-method-uuid",level:4},{value:"<code>year()</code>",id:"column-method-year",level:4},{value:"Column Modifiers",id:"column-modifiers",level:3},{value:"Default Expressions",id:"default-expressions",level:4},{value:"Column Order",id:"column-order",level:4},{value:"Modifying Columns",id:"modifying-columns",level:3},{value:"Renaming Columns",id:"renaming-columns",level:4},{value:"Dropping Columns",id:"dropping-columns",level:3},{value:"Available Command Aliases",id:"available-command-aliases",level:4},{value:"Indexes",id:"indexes",level:2},{value:"Creating Indexes",id:"creating-indexes",level:3},{value:"Available Index Types",id:"available-index-types",level:4},{value:"Index Lengths &amp; MySQL / MariaDB",id:"index-lengths--mysql--mariadb",level:4},{value:"Renaming Indexes",id:"renaming-indexes",level:3},{value:"Dropping Indexes",id:"dropping-indexes",level:3},{value:"Foreign Key Constraints",id:"foreign-key-constraints",level:3},{value:"Dropping Foreign Keys",id:"dropping-foreign-keys",level:4},{value:"Toggling Foreign Key Constraints",id:"toggling-foreign-key-constraints",level:4}],b={toc:N};function v(e){var t=e.components,n=(0,i.Z)(e,u);return(0,l.kt)("wrapper",(0,a.Z)({},b,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"database-migrations"},"Database: Migrations"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#introduction"},"Introduction")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#generating-migrations"},"Generating Migrations")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#tab-completion"},"Tab completion")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#migration-structure"},"Migration Structure")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#running-migrations"},"Running Migrations"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#rolling-back-migrations"},"Rolling Back Migrations")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#tables"},"Tables"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#creating-tables"},"Creating Tables")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#updating-tables"},"Updating Tables")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#renaming-and-dropping-tables"},"Renaming / Dropping Tables")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#columns"},"Columns"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#creating-columns"},"Creating Columns")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#available-column-types"},"Available Column Types")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#column-modifiers"},"Column Modifiers")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#modifying-columns"},"Modifying Columns")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#dropping-columns"},"Dropping Columns")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#indexes"},"Indexes"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#creating-indexes"},"Creating Indexes")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#renaming-indexes"},"Renaming Indexes")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#dropping-indexes"},"Dropping Indexes")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#foreign-key-constraints"},"Foreign Key Constraints"))))),(0,l.kt)("h2",{id:"introduction"},"Introduction"),(0,l.kt)("p",null,"Migrations are like version control for your database, allowing your team to define and share the application's database schema definition. If you have ever had to tell a teammate to manually add a column to their local database schema after pulling in your changes from source control, you've faced the problem that database migrations solve."),(0,l.kt)("p",null,"The TinyORM ",(0,l.kt)("inlineCode",{parentName:"p"},"Schema")," facade provides database agnostic support for creating and manipulating tables across all of TinyORM's supported database systems. Typically, migrations will use this facade to create and modify database tables and columns."),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Tom")," migrations is a small console application that depends on the ",(0,l.kt)("inlineCode",{parentName:"p"},"TinyORM")," library. All migrations logic is compiled so recompilation is needed after adding a new migration class."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Currently, TinyORM's schema builder provides first-party support for the MySQL and PostgreSQL database. Support for the SQLite databases is not implemented \ud83d\ude22."))),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"The ",(0,l.kt)("a",{parentName:"p",href:"/database/migrations#tables"},(0,l.kt)("inlineCode",{parentName:"a"},"schema builder"))," and ",(0,l.kt)("a",{parentName:"p",href:"/database/migrations"},(0,l.kt)("inlineCode",{parentName:"a"},"migrations"))," don't support ",(0,l.kt)("a",{parentName:"p",href:"/database/getting-started#multi-threading-support"},"multi-threading"),"."))),(0,l.kt)("h2",{id:"generating-migrations"},"Generating Migrations"),(0,l.kt)("p",null,"You may use the ",(0,l.kt)("inlineCode",{parentName:"p"},"make:migration")," ",(0,l.kt)("inlineCode",{parentName:"p"},"tom")," command to generate a database migration. The new migration will be placed in your ",(0,l.kt)("inlineCode",{parentName:"p"},"database/migrations")," directory. Each migration filename contains a timestamp that allows ",(0,l.kt)("inlineCode",{parentName:"p"},"tom")," to determine the order of the migrations:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"tom make:migration create_posts_table\n")),(0,l.kt)("p",null,"tom will use the name of the migration to attempt to guess the name of the table and whether or not the migration will be creating a new table. If ",(0,l.kt)("inlineCode",{parentName:"p"},"tom")," is able to determine the table name from the migration name, ",(0,l.kt)("inlineCode",{parentName:"p"},"tom")," will pre-fill the generated migration file with the specified table. Otherwise, you may simply specify the table in the migration file manually."),(0,l.kt)("p",null,"If you would like to specify a custom path for the generated migration, you may use the ",(0,l.kt)("inlineCode",{parentName:"p"},"--path")," option when executing the ",(0,l.kt)("inlineCode",{parentName:"p"},"make:migration")," command. The given path should be relative to your ",(0,l.kt)("abbr",{title:"Current working directory"},"pwd")," or you can use the ",(0,l.kt)("inlineCode",{parentName:"p"},"--realpath")," option and pass the absolute path to the ",(0,l.kt)("inlineCode",{parentName:"p"},"--path")," option."),(0,l.kt)("h4",{id:"migrations-naming-rules"},"Migrations naming rules"),(0,l.kt)("p",null,"If the migration name starts with the ",(0,l.kt)("inlineCode",{parentName:"p"},"create_")," string then the stub for table creation will be used and if the migration name contains ",(0,l.kt)("inlineCode",{parentName:"p"},"_(from|to|in)_")," then the stub for table update will be used. You can override these rules using the ",(0,l.kt)("inlineCode",{parentName:"p"},"--create")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"--table")," options and specify the table name manually."),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"You can also pass the full migration filename with the datetime prefix and extension to the ",(0,l.kt)("inlineCode",{parentName:"p"},"make:migration"),". This command is able to detect almost any combination of the passed value, with or without datetime prefix or extension if it is the filename; or StudlyCase, snake_case, or kebab-case if it is the classname or any combination described above. \ud83d\udc40"))),(0,l.kt)("h2",{id:"tab-completion"},"Tab completion"),(0,l.kt)("p",null,"Tab completion is available for the ",(0,l.kt)("inlineCode",{parentName:"p"},"pwsh")," (on Linux too), ",(0,l.kt)("inlineCode",{parentName:"p"},"bash"),", and ",(0,l.kt)("inlineCode",{parentName:"p"},"zsh")," shells. For ",(0,l.kt)("inlineCode",{parentName:"p"},"pwsh")," the ",(0,l.kt)("inlineCode",{parentName:"p"},"tom.exe")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"TinyOrm0.dll")," library must be on the system path to work properly. With ",(0,l.kt)("inlineCode",{parentName:"p"},"bash")," if the ",(0,l.kt)("inlineCode",{parentName:"p"},"tom")," executable and ",(0,l.kt)("inlineCode",{parentName:"p"},"libTinyOrm.so")," library is ",(0,l.kt)("strong",{parentName:"p"},"not")," on the system path then it will provide less accurate completions."),(0,l.kt)("p",null,"You can enable it using the following commands."),(0,l.kt)(d.Z,{groupId:p.IZ,mdxType:"Tabs"},(0,l.kt)(m.Z,{value:p.Fo,label:p.IM,mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-powershell"},"tom integrate pwsh\n"))),(0,l.kt)(m.Z,{value:p.q5,label:p.C,mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"tom integrate bash\n"))),(0,l.kt)(m.Z,{value:"zsh",label:"zsh",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"tom integrate zsh\ntom integrate zsh --path=/usr/share/zsh/site-functions\n")))),(0,l.kt)("p",null,"Or you can enable it manually. Following actions are the same as the ",(0,l.kt)("inlineCode",{parentName:"p"},"tom integrate")," command does."),(0,l.kt)("p",null,"For the ",(0,l.kt)("inlineCode",{parentName:"p"},"pwsh")," paste the following code to the pwsh profile (works on Linux or Windows)."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-powershell",metastring:"title='~/Documents/PowerShell/Microsoft.PowerShell_profile.ps1'",title:"'~/Documents/PowerShell/Microsoft.PowerShell_profile.ps1'"},"Register-ArgumentCompleter -Native -CommandName tom -ScriptBlock {\n    param($wordToComplete, $commandAst, $cursorPosition)\n    [Console]::InputEncoding = [Console]::OutputEncoding = $OutputEncoding = [System.Text.Utf8Encoding]::new()\n    $Local:word = $wordToComplete.Replace('\"', '\"\"')\n    $Local:ast = $commandAst.ToString().Replace('\"', '\"\"')\n    tom complete --word=\"$Local:word\" --commandline=\"$Local:ast\" --position=$cursorPosition | ForEach-Object {\n            $completionText, $listText, $toolTip = $_ -split ';', 3\n            $listText ??= $completionText\n            $toolTip ??= $completionText\n            [System.Management.Automation.CompletionResult]::new(\n                $completionText, $listText, 'ParameterValue', $toolTip)\n        }\n}\n")),(0,l.kt)("p",null,"For ",(0,l.kt)("inlineCode",{parentName:"p"},"bash")," you can copy or create symlink of the ",(0,l.kt)("inlineCode",{parentName:"p"},"/tools/completions/tom.bash")," file to the ",(0,l.kt)("inlineCode",{parentName:"p"},"/usr/share/bash-completion/completions")," folder."),(0,l.kt)(r.Z,{className:"language-bash",mdxType:"CodeBlock"},"sudo ln -s "+(0,s.go)(p.q5)+"/TinyORM/tools/completions/tom.bash /usr/share/bash-completion/completions/tom"),(0,l.kt)("p",null,"And for ",(0,l.kt)("inlineCode",{parentName:"p"},"zsh")," you can copy or create symlink of the ",(0,l.kt)("inlineCode",{parentName:"p"},"/tools/completions/tom.zsh")," file to the ",(0,l.kt)("inlineCode",{parentName:"p"},"_tom")," file to ",(0,l.kt)("inlineCode",{parentName:"p"},"/usr/local/share/zsh/site-functions")," folder."),(0,l.kt)(r.Z,{className:"language-bash",mdxType:"CodeBlock"},"sudo ln -s "+(0,s.go)(p.q5)+"/TinyORM/tools/completions/tom.zsh /usr/local/share/zsh/site-functions/_tom"),(0,l.kt)("p",null,"It will provide completions for the ",(0,l.kt)("inlineCode",{parentName:"p"},"tom")," commands, long and short parameters, and also for some positional arguments like namespaces for the ",(0,l.kt)("inlineCode",{parentName:"p"},"list")," command or commands for the ",(0,l.kt)("inlineCode",{parentName:"p"},"help")," command."),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"The ",(0,l.kt)("inlineCode",{parentName:"p"},"tom integrate zsh")," command also accepts the ",(0,l.kt)("inlineCode",{parentName:"p"},"--path=")," option with which you can set the location, where the completion file should be created."))),(0,l.kt)("h2",{id:"migration-structure"},"Migration Structure"),(0,l.kt)("p",null,"A migration class contains two methods: ",(0,l.kt)("inlineCode",{parentName:"p"},"up")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"down"),". The ",(0,l.kt)("inlineCode",{parentName:"p"},"up")," method is used to add new tables, columns, or indexes to your database, while the ",(0,l.kt)("inlineCode",{parentName:"p"},"down")," method should reverse the operations performed by the ",(0,l.kt)("inlineCode",{parentName:"p"},"up")," method."),(0,l.kt)("p",null,"Within both of these methods, you may use the TinyORM schema builder to expressively create and modify tables. To learn about all of the methods available on the ",(0,l.kt)("inlineCode",{parentName:"p"},"Schema")," builder, ",(0,l.kt)("a",{parentName:"p",href:"#creating-tables"},"check out its documentation"),". For example, the following migration creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"posts")," table:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'#pragma once\n\n#include <tom/migration.hpp>\n\nnamespace Migrations\n{\n\n    struct CreatePostsTable : Migration\n    {\n        /*! Filename of the migration file. */\n        T_MIGRATION\n\n        /*! Run the migrations. */\n        void up() const override\n        {\n            Schema::create("posts", [](Blueprint &table)\n            {\n                table.id();\n\n                table.string(NAME);\n                table.timestamps();\n            });\n        }\n\n        /*! Reverse the migrations. */\n        void down() const override\n        {\n            Schema::dropIfExists("posts");\n        }\n    };\n\n} // namespace Migrations\n')),(0,l.kt)("p",null,"Migration classes can be named in two formats, StudlyCase without the datetime prefix and snake_case with the datetime prefix. If the StudlyCase name is used then the ",(0,l.kt)("inlineCode",{parentName:"p"},"T_MIGRATION")," macro must also be used in the migration class."),(0,l.kt)("p",null,"Naming with the datetime prefix should look like this."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"struct _2014_10_12_000000_create_posts_table : Migration\n{\n\n    /*! Run the migrations. */\n    void up() const override\n    {\n        //\n    }\n\n    /*! Reverse the migrations. */\n    void down() const override\n    {\n        //\n    }\n};\n")),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"The StudlyCase naming is preferred. Also the ",(0,l.kt)("inlineCode",{parentName:"p"},"make:migration")," command generates migrations in this format."))),(0,l.kt)("h4",{id:"setting-the-migration-connection"},"Setting The Migration Connection"),(0,l.kt)("p",null,"If your migration will be interacting with a database connection other than your application's default database connection, you should set the ",(0,l.kt)("inlineCode",{parentName:"p"},"connection")," data member of your migration:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'/*! The name of the database connection to use. */\nQString connection = QStringLiteral("tinyorm_example");\n\n/*! Run the migrations. */\nvoid up() const override\n{\n    //\n}\n')),(0,l.kt)("h2",{id:"running-migrations"},"Running Migrations"),(0,l.kt)("p",null,"To run all of your outstanding migrations, execute the ",(0,l.kt)("inlineCode",{parentName:"p"},"migrate")," Tom command:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"tom migrate\n")),(0,l.kt)("p",null,"If you would like to see which migrations have run thus far, you may use the ",(0,l.kt)("inlineCode",{parentName:"p"},"migrate:status")," tom command:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"tom migrate:status\n")),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Many ",(0,l.kt)("inlineCode",{parentName:"p"},"tom")," commands offer variety of options, you can explore them using the ",(0,l.kt)("inlineCode",{parentName:"p"},"tom list")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"tom help")," commands. In most cases, these commands and options are self-explanatory."))),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"The ",(0,l.kt)("inlineCode",{parentName:"p"},"tom")," command is able to guess the command name and command namespace, eg. ",(0,l.kt)("inlineCode",{parentName:"p"},"tom mig:st")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"tom m:rol"),", ..."))),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"You can pass the ",(0,l.kt)("inlineCode",{parentName:"p"},"-vvv")," command-line argument to any command to see all executed SQL queries. \ud83d\udc4c"))),(0,l.kt)("h4",{id:"forcing-migrations-to-run-in-production"},"Forcing Migrations To Run In Production"),(0,l.kt)("p",null,"Some migration operations are destructive, which means they may cause you to lose data. In order to protect you from running these commands against your production database, you will be prompted for confirmation before the commands are executed. To force the commands to run without a prompt, use the ",(0,l.kt)("inlineCode",{parentName:"p"},"--force")," flag:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"tom migrate --force\n")),(0,l.kt)("h3",{id:"rolling-back-migrations"},"Rolling Back Migrations"),(0,l.kt)("p",null,"To roll back the latest migration operation, you may use the ",(0,l.kt)("inlineCode",{parentName:"p"},"rollback"),' Tom command. This command rolls back the last "batch" of migrations, which may include multiple migration files:'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"tom migrate:rollback\n")),(0,l.kt)("p",null,"You may roll back a limited number of migrations by providing the ",(0,l.kt)("inlineCode",{parentName:"p"},"step")," option to the ",(0,l.kt)("inlineCode",{parentName:"p"},"rollback")," command. For example, the following command will roll back the last five migrations:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"tom migrate:rollback --step=5\n")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"migrate:reset")," command will roll back all of your application's migrations:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"tom migrate:reset\n")),(0,l.kt)("h4",{id:"roll-back--migrate-using-a-single-command"},"Roll Back & Migrate Using A Single Command"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"migrate:refresh")," command will roll back all of your migrations and then execute the ",(0,l.kt)("inlineCode",{parentName:"p"},"migrate")," command. This command effectively re-creates your entire database:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"tom migrate:refresh\n")),(0,l.kt)("p",null,"You may roll back and re-migrate a limited number of migrations by providing the ",(0,l.kt)("inlineCode",{parentName:"p"},"step")," option to the ",(0,l.kt)("inlineCode",{parentName:"p"},"refresh")," command. For example, the following command will roll back and re-migrate the last five migrations:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"tom migrate:refresh --step=5\n")),(0,l.kt)("h4",{id:"drop-all-tables--migrate"},"Drop All Tables & Migrate"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"migrate:fresh")," command will drop all tables from the database and then execute the ",(0,l.kt)("inlineCode",{parentName:"p"},"migrate")," command:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"tom migrate:fresh\n")),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"The ",(0,l.kt)("inlineCode",{parentName:"p"},"migrate:fresh")," command will drop all database tables regardless of their prefix. This command should be used with caution when developing on a database that is shared with other applications."))),(0,l.kt)("h2",{id:"tables"},"Tables"),(0,l.kt)("h3",{id:"creating-tables"},"Creating Tables"),(0,l.kt)("p",null,"To create a new database table, use the ",(0,l.kt)("inlineCode",{parentName:"p"},"create")," method on the ",(0,l.kt)("inlineCode",{parentName:"p"},"Schema")," facade. The ",(0,l.kt)("inlineCode",{parentName:"p"},"create")," method accepts two arguments: the first is the name of the table, while the second is a lambda expression which receives a ",(0,l.kt)("inlineCode",{parentName:"p"},"Orm::SchemaNs::Blueprint")," object that may be used to define the new table:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'#include <orm/schema.hpp>\n\nusing Orm::Schema;\n\nSchema::create("users", [](Blueprint &table)\n{\n    table.id();\n    table.string("name");\n    table.string("email");\n    table.timestamps();\n});\n')),(0,l.kt)("p",null,"When creating the table, you may use any of the schema builder's ",(0,l.kt)("a",{parentName:"p",href:"#creating-columns"},"column methods")," to define the table's columns."),(0,l.kt)("h4",{id:"checking-for-table--column-existence"},"Checking For Table / Column Existence"),(0,l.kt)("p",null,"You may check for the existence of a table or column using the ",(0,l.kt)("inlineCode",{parentName:"p"},"hasTable")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"hasColumn")," methods:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'if (Schema::hasTable("users")) {\n    // The "users" table exists...\n}\n\nif (Schema::hasColumn("users", "email")) {\n    // The "users" table exists and has an "email" column...\n}\n')),(0,l.kt)("h4",{id:"database-connection--table-options"},"Database Connection & Table Options"),(0,l.kt)("p",null,"If you want to perform a schema operation on a database connection that is not your application's default connection, use the ",(0,l.kt)("inlineCode",{parentName:"p"},"connection")," method or ",(0,l.kt)("inlineCode",{parentName:"p"},"on")," alias:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'Schema::connection("postgres").create("users", [](Blueprint &table)\n{\n    table.id();\n});\n')),(0,l.kt)("p",null,"In addition, a few other data members and methods may be used to define other aspects of the table's creation. The ",(0,l.kt)("inlineCode",{parentName:"p"},"engine")," data member may be used to specify the table's storage engine when using MySQL:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'#include <orm/constants.hpp>\n\nSchema::create("users", [](Blueprint &table)\n{\n    table.engine = Orm::InnoDB;\n\n    // ...\n});\n')),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"charset")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"collation")," data members may be used to specify the character set and collation for the created table when using MySQL:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'#include <orm/constants.hpp>\n\nusing Orm::Constants::UTF8MB4;\n\nSchema::create("users", [](Blueprint &table)\n{\n    table.charset = UTF8MB4;\n    table.collation = "utf8mb4_unicode_ci";\n\n    // ...\n});\n')),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"temporary"),' method may be used to indicate that the table should be "temporary". Temporary tables are only visible to the current connection\'s database session and are dropped automatically when the connection is closed:'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'Schema::create("calculations", [](Blueprint &table)\n{\n    table.temporary();\n\n    // ...\n});\n')),(0,l.kt)("h3",{id:"updating-tables"},"Updating Tables"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"table")," method on the ",(0,l.kt)("inlineCode",{parentName:"p"},"Schema")," facade may be used to update existing tables. Like the ",(0,l.kt)("inlineCode",{parentName:"p"},"create")," method, the ",(0,l.kt)("inlineCode",{parentName:"p"},"table")," method accepts two arguments: the name of the table and a lambda expression that receives a ",(0,l.kt)("inlineCode",{parentName:"p"},"Blueprint")," instance you may use to add columns or indexes to the table:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'#include <orm/schema.hpp>\n\nSchema::table("users", [](Blueprint &table)\n{\n    table.integer("votes");\n});\n')),(0,l.kt)("h3",{id:"renaming-and-dropping-tables"},"Renaming / Dropping Tables"),(0,l.kt)("p",null,"To rename an existing database table, use the ",(0,l.kt)("inlineCode",{parentName:"p"},"rename")," method:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'#include <orm/schema.hpp>\n\nSchema::rename("from", "to");\n')),(0,l.kt)("p",null,"To drop an existing table, you may use the ",(0,l.kt)("inlineCode",{parentName:"p"},"drop")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"dropIfExists")," methods:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'Schema::drop("users");\n\nSchema::dropIfExists("users");\n')),(0,l.kt)("h4",{id:"renaming-tables-with-foreign-keys"},"Renaming Tables With Foreign Keys"),(0,l.kt)("p",null,"Before renaming a table, you should verify that any foreign key constraints on the table have an explicit name in your migration files instead of letting TinyORM assign a convention based name. Otherwise, the foreign key constraint ",(0,l.kt)("strong",{parentName:"p"},"index name")," will refer to the old table name."),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"After renaming a table, you can re-create (drop and create again) the foreign key constraints to fix an ",(0,l.kt)("strong",{parentName:"p"},"index name"),", so it refers to a renamed table."))),(0,l.kt)("h2",{id:"columns"},"Columns"),(0,l.kt)("h3",{id:"creating-columns"},"Creating Columns"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"table")," method on the ",(0,l.kt)("inlineCode",{parentName:"p"},"Schema")," facade may be used to update existing tables. Like the ",(0,l.kt)("inlineCode",{parentName:"p"},"create")," method, the ",(0,l.kt)("inlineCode",{parentName:"p"},"table")," method accepts two arguments: the name of the table and a lambda expression that receives a ",(0,l.kt)("inlineCode",{parentName:"p"},"Blueprint")," instance you may use to add columns to the table:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'#include <orm/schema.hpp>\n\nSchema::table("users", [](Blueprint &table)\n{\n    table.integer("votes");\n});\n')),(0,l.kt)("h3",{id:"available-column-types"},"Available Column Types"),(0,l.kt)("p",null,"The schema builder blueprint offers a variety of methods that correspond to the different types of columns you can add to your database tables. Each of the available methods are listed in the table below:"),(0,l.kt)("div",{id:"collection-method-list"},(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#column-method-bigIncrements"},"bigIncrements"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-bigInteger"},"bigInteger"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-binary"},"binary"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-boolean"},"boolean"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-Char"},"Char"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-dateTimeTz"},"dateTimeTz"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-dateTime"},"dateTime"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-date"},"date"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-decimal"},"decimal"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-Double"},"Double"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-Enum"},"Enum"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-Float"},"Float"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-foreignId"},"foreignId"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-foreignIdFor"},"foreignIdFor"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-foreignUuid"},"foreignUuid"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-geometryCollection"},"geometryCollection"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-geometry"},"geometry"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-id"},"id"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-increments"},"increments"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-integer"},"integer"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-ipAddress"},"ipAddress"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-json"},"json"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-jsonb"},"jsonb"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-lineString"},"lineString"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-longText"},"longText"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-macAddress"},"macAddress"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-mediumIncrements"},"mediumIncrements"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-mediumInteger"},"mediumInteger"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-mediumText"},"mediumText"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-multiLineString"},"multiLineString"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-multiPoint"},"multiPoint"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-multiPolygon"},"multiPolygon"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-point"},"point"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-polygon"},"polygon"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-rememberToken"},"rememberToken"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-set"},"set"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-smallIncrements"},"smallIncrements"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-smallInteger"},"smallInteger"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-string"},"string"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-text"},"text"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-timeTz"},"timeTz"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-time"},"time"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-timestampTz"},"timestampTz"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-timestamp"},"timestamp"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-timestampsTz"},"timestampsTz"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-timestamps"},"timestamps"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-tinyIncrements"},"tinyIncrements"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-tinyInteger"},"tinyInteger"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-tinyText"},"tinyText"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-unsignedBigInteger"},"unsignedBigInteger"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-unsignedDecimal"},"unsignedDecimal"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-unsignedInteger"},"unsignedInteger"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-unsignedMediumInteger"},"unsignedMediumInteger"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-unsignedSmallInteger"},"unsignedSmallInteger"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-unsignedTinyInteger"},"unsignedTinyInteger"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-uuid"},"uuid"),"\n",(0,l.kt)("a",{parentName:"p",href:"#column-method-year"},"year"))),(0,l.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Names of ",(0,l.kt)("inlineCode",{parentName:"p"},"Char"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"Double"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"Enum"),", and ",(0,l.kt)("inlineCode",{parentName:"p"},"Float")," column methods are in the CamelCase format to avoid collisions with c++ keywords."))),(0,l.kt)("div",{id:"collection-methods"},(0,l.kt)("h4",{id:"column-method-bigIncrements"},(0,l.kt)("inlineCode",{parentName:"h4"},"bigIncrements()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"bigIncrements")," method creates an auto-incrementing ",(0,l.kt)("inlineCode",{parentName:"p"},"UNSIGNED BIGINT")," (primary key) equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"#include <orm/constants.hpp>\n\ntable.bigIncrements(Orm::ID);\n")),(0,l.kt)("h4",{id:"column-method-bigInteger"},(0,l.kt)("inlineCode",{parentName:"h4"},"bigInteger()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"bigInteger")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"BIGINT")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.bigInteger("votes");\n')),(0,l.kt)("h4",{id:"column-method-binary"},(0,l.kt)("inlineCode",{parentName:"h4"},"binary()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"binary")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"BLOB")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.binary("photo");\n')),(0,l.kt)("h4",{id:"column-method-boolean"},(0,l.kt)("inlineCode",{parentName:"h4"},"boolean()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"boolean")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"BOOLEAN")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.boolean("confirmed");\n')),(0,l.kt)("h4",{id:"column-method-Char"},(0,l.kt)("inlineCode",{parentName:"h4"},"Char()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"Char")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"CHAR")," equivalent column with of a given length:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"#include <orm/constants.hpp>\n\ntable.Char(Orm::NAME, 100);\n")),(0,l.kt)("h4",{id:"column-method-dateTimeTz"},(0,l.kt)("inlineCode",{parentName:"h4"},"dateTimeTz()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"dateTimeTz")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"DATETIME")," (with timezone) equivalent column with an optional precision (total digits):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"#include <orm/constants.hpp>\n\ntable.dateTimeTz(Orm::CREATED_AT, precision = 0);\n")),(0,l.kt)("h4",{id:"column-method-dateTime"},(0,l.kt)("inlineCode",{parentName:"h4"},"dateTime()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"dateTime")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"DATETIME")," equivalent column with an optional precision (total digits):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.dateTime("created_at", precision = 0);\n')),(0,l.kt)("h4",{id:"column-method-date"},(0,l.kt)("inlineCode",{parentName:"h4"},"date()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"date")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"DATE")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.date("created_at");\n')),(0,l.kt)("h4",{id:"column-method-decimal"},(0,l.kt)("inlineCode",{parentName:"h4"},"decimal()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"decimal")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"DECIMAL")," equivalent column with the given precision (total digits) and scale (decimal digits):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.decimal("amount", precision = 8, scale = 2);\n')),(0,l.kt)("h4",{id:"column-method-Double"},(0,l.kt)("inlineCode",{parentName:"h4"},"Double()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"Double")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"DOUBLE")," equivalent column with the given precision (total digits) and scale (decimal digits):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.Double("amount", 8, 2);\n')),(0,l.kt)("h4",{id:"column-method-Enum"},(0,l.kt)("inlineCode",{parentName:"h4"},"Enum()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"Enum")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"ENUM")," equivalent column with the given valid values:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.Enum("difficulty", {"easy", "hard"});\n')),(0,l.kt)("h4",{id:"column-method-Float"},(0,l.kt)("inlineCode",{parentName:"h4"},"Float()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"Float")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"FLOAT")," equivalent column with the given precision (total digits) and scale (decimal digits):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.Float("amount", 8, 2);\n')),(0,l.kt)("h4",{id:"column-method-foreignId"},(0,l.kt)("inlineCode",{parentName:"h4"},"foreignId()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"foreignId")," method creates an ",(0,l.kt)("inlineCode",{parentName:"p"},"UNSIGNED BIGINT")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.foreignId("user_id");\n')),(0,l.kt)("h4",{id:"column-method-foreignIdFor"},(0,l.kt)("inlineCode",{parentName:"h4"},"foreignIdFor()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"foreignIdFor")," method adds a ",(0,l.kt)("inlineCode",{parentName:"p"},"{column}_id UNSIGNED BIGINT")," equivalent column for a given model class:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'#include "models/user.hpp"\n\nModels::User user;\n\ntable.foreignIdFor(User);\n')),(0,l.kt)("h4",{id:"column-method-foreignUuid"},(0,l.kt)("inlineCode",{parentName:"h4"},"foreignUuid()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"foreignUuid")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"UUID")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.foreignUuid("user_id");\n')),(0,l.kt)("h4",{id:"column-method-geometryCollection"},(0,l.kt)("inlineCode",{parentName:"h4"},"geometryCollection()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"geometryCollection")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"GEOMETRYCOLLECTION")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.geometryCollection("positions");\n')),(0,l.kt)("h4",{id:"column-method-geometry"},(0,l.kt)("inlineCode",{parentName:"h4"},"geometry()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"geometry")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"GEOMETRY")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.geometry("positions");\n')),(0,l.kt)("h4",{id:"column-method-id"},(0,l.kt)("inlineCode",{parentName:"h4"},"id()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"id")," method is an alias of the ",(0,l.kt)("inlineCode",{parentName:"p"},"bigIncrements")," method. By default, the method will create an ",(0,l.kt)("inlineCode",{parentName:"p"},"id")," column; however, you may pass a column name if you would like to assign a different name to the column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"table.id();\n")),(0,l.kt)("h4",{id:"column-method-increments"},(0,l.kt)("inlineCode",{parentName:"h4"},"increments()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"increments")," method creates an auto-incrementing ",(0,l.kt)("inlineCode",{parentName:"p"},"UNSIGNED INTEGER")," equivalent column as a primary key:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.increments("id");\n')),(0,l.kt)("h4",{id:"column-method-integer"},(0,l.kt)("inlineCode",{parentName:"h4"},"integer()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"integer")," method creates an ",(0,l.kt)("inlineCode",{parentName:"p"},"INTEGER")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.integer("votes");\n')),(0,l.kt)("h4",{id:"column-method-ipAddress"},(0,l.kt)("inlineCode",{parentName:"h4"},"ipAddress()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"ipAddress")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"VARCHAR(45)")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.ipAddress("visitor");\n')),(0,l.kt)("h4",{id:"column-method-json"},(0,l.kt)("inlineCode",{parentName:"h4"},"json()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"json")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"JSON")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.json("options");\n')),(0,l.kt)("h4",{id:"column-method-jsonb"},(0,l.kt)("inlineCode",{parentName:"h4"},"jsonb()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"jsonb")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"JSONB")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.jsonb("options");\n')),(0,l.kt)("h4",{id:"column-method-lineString"},(0,l.kt)("inlineCode",{parentName:"h4"},"lineString()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"lineString")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"LINESTRING")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.lineString("positions");\n')),(0,l.kt)("h4",{id:"column-method-longText"},(0,l.kt)("inlineCode",{parentName:"h4"},"longText()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"longText")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"LONGTEXT")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.longText("description");\n')),(0,l.kt)("h4",{id:"column-method-macAddress"},(0,l.kt)("inlineCode",{parentName:"h4"},"macAddress()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"macAddress")," method creates a column that is intended to hold a MAC address. Some database systems, such as PostgreSQL, have a dedicated column type for this type of data. Other database systems will use a string equivalent ",(0,l.kt)("inlineCode",{parentName:"p"},"VARCHAR(17)")," column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.macAddress("device");\n')),(0,l.kt)("h4",{id:"column-method-mediumIncrements"},(0,l.kt)("inlineCode",{parentName:"h4"},"mediumIncrements()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"mediumIncrements")," method creates an auto-incrementing ",(0,l.kt)("inlineCode",{parentName:"p"},"UNSIGNED MEDIUMINT")," equivalent column as a primary key:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.mediumIncrements("id");\n')),(0,l.kt)("h4",{id:"column-method-mediumInteger"},(0,l.kt)("inlineCode",{parentName:"h4"},"mediumInteger()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"mediumInteger")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"MEDIUMINT")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.mediumInteger("votes");\n')),(0,l.kt)("h4",{id:"column-method-mediumText"},(0,l.kt)("inlineCode",{parentName:"h4"},"mediumText()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"mediumText")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"MEDIUMTEXT")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.mediumText("description");\n')),(0,l.kt)("h4",{id:"column-method-multiLineString"},(0,l.kt)("inlineCode",{parentName:"h4"},"multiLineString()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"multiLineString")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"MULTILINESTRING")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.multiLineString("positions");\n')),(0,l.kt)("h4",{id:"column-method-multiPoint"},(0,l.kt)("inlineCode",{parentName:"h4"},"multiPoint()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"multiPoint")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"MULTIPOINT")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.multiPoint("positions");\n')),(0,l.kt)("h4",{id:"column-method-multiPolygon"},(0,l.kt)("inlineCode",{parentName:"h4"},"multiPolygon()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"multiPolygon")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"MULTIPOLYGON")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.multiPolygon("positions");\n')),(0,l.kt)("h4",{id:"column-method-point"},(0,l.kt)("inlineCode",{parentName:"h4"},"point()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"point")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"POINT")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.point("position");\n')),(0,l.kt)("h4",{id:"column-method-polygon"},(0,l.kt)("inlineCode",{parentName:"h4"},"polygon()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"polygon")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"POLYGON")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.polygon("position");\n')),(0,l.kt)("h4",{id:"column-method-rememberToken"},(0,l.kt)("inlineCode",{parentName:"h4"},"rememberToken()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"rememberToken")," method creates a nullable, ",(0,l.kt)("inlineCode",{parentName:"p"},"VARCHAR(100)"),' equivalent column that is intended to store the current "remember me" authentication token:'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"table.rememberToken();\n")),(0,l.kt)("h4",{id:"column-method-set"},(0,l.kt)("inlineCode",{parentName:"h4"},"set()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"set")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"SET")," equivalent column with the given list of valid values:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.set("flavors", {"strawberry", "vanilla"});\n')),(0,l.kt)("h4",{id:"column-method-smallIncrements"},(0,l.kt)("inlineCode",{parentName:"h4"},"smallIncrements()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"smallIncrements")," method creates an auto-incrementing ",(0,l.kt)("inlineCode",{parentName:"p"},"UNSIGNED SMALLINT")," equivalent column as a primary key:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.smallIncrements("id");\n')),(0,l.kt)("h4",{id:"column-method-smallInteger"},(0,l.kt)("inlineCode",{parentName:"h4"},"smallInteger()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"smallInteger")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"SMALLINT")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.smallInteger("votes");\n')),(0,l.kt)("h4",{id:"column-method-string"},(0,l.kt)("inlineCode",{parentName:"h4"},"string()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"string")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"VARCHAR")," equivalent column of the given length:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"#include <orm/constants.hpp>\n\ntable.string(Orm::NAME, 100);\n")),(0,l.kt)("h4",{id:"column-method-text"},(0,l.kt)("inlineCode",{parentName:"h4"},"text()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"text")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"TEXT")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.text("description");\n')),(0,l.kt)("h4",{id:"column-method-timeTz"},(0,l.kt)("inlineCode",{parentName:"h4"},"timeTz()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"timeTz")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"TIME")," (with timezone) equivalent column with an optional precision (total digits):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.timeTz("sunrise", precision = 0);\n')),(0,l.kt)("h4",{id:"column-method-time"},(0,l.kt)("inlineCode",{parentName:"h4"},"time()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"time")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"TIME")," equivalent column with an optional precision (total digits):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.time("sunrise", precision = 0);\n')),(0,l.kt)("h4",{id:"column-method-timestampTz"},(0,l.kt)("inlineCode",{parentName:"h4"},"timestampTz()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"timestampTz")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"TIMESTAMP")," (with timezone) equivalent column with an optional precision (total digits):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.timestampTz("added_at", precision = 0);\n')),(0,l.kt)("h4",{id:"column-method-timestamp"},(0,l.kt)("inlineCode",{parentName:"h4"},"timestamp()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"timestamp")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"TIMESTAMP")," equivalent column with an optional precision (total digits):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.timestamp("added_at", precision = 0);\n')),(0,l.kt)("h4",{id:"column-method-timestampsTz"},(0,l.kt)("inlineCode",{parentName:"h4"},"timestampsTz()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"timestampsTz")," method creates ",(0,l.kt)("inlineCode",{parentName:"p"},"created_at")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"updated_at")," ",(0,l.kt)("inlineCode",{parentName:"p"},"TIMESTAMP")," (with timezone) equivalent columns with an optional precision (total digits):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"table.timestampsTz(precision = 0);\n")),(0,l.kt)("h4",{id:"column-method-timestamps"},(0,l.kt)("inlineCode",{parentName:"h4"},"timestamps()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"timestamps")," method creates ",(0,l.kt)("inlineCode",{parentName:"p"},"created_at")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"updated_at")," ",(0,l.kt)("inlineCode",{parentName:"p"},"TIMESTAMP")," equivalent columns with an optional precision (total digits):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"table.timestamps(precision = 0);\n")),(0,l.kt)("h4",{id:"column-method-tinyIncrements"},(0,l.kt)("inlineCode",{parentName:"h4"},"tinyIncrements()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"tinyIncrements")," method creates an auto-incrementing ",(0,l.kt)("inlineCode",{parentName:"p"},"UNSIGNED TINYINT")," equivalent column as a primary key:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.tinyIncrements("id");\n')),(0,l.kt)("h4",{id:"column-method-tinyInteger"},(0,l.kt)("inlineCode",{parentName:"h4"},"tinyInteger()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"tinyInteger")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"TINYINT")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.tinyInteger("votes");\n')),(0,l.kt)("h4",{id:"column-method-tinyText"},(0,l.kt)("inlineCode",{parentName:"h4"},"tinyText()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"tinyText")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"TINYTEXT")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.tinyText("notes");\n')),(0,l.kt)("h4",{id:"column-method-unsignedBigInteger"},(0,l.kt)("inlineCode",{parentName:"h4"},"unsignedBigInteger()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"unsignedBigInteger")," method creates an ",(0,l.kt)("inlineCode",{parentName:"p"},"UNSIGNED BIGINT")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.unsignedBigInteger("votes");\n')),(0,l.kt)("h4",{id:"column-method-unsignedDecimal"},(0,l.kt)("inlineCode",{parentName:"h4"},"unsignedDecimal()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"unsignedDecimal")," method creates an ",(0,l.kt)("inlineCode",{parentName:"p"},"UNSIGNED DECIMAL")," equivalent column with an optional precision (total digits) and scale (decimal digits):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.unsignedDecimal("amount", precision = 8, scale = 2);\n')),(0,l.kt)("h4",{id:"column-method-unsignedInteger"},(0,l.kt)("inlineCode",{parentName:"h4"},"unsignedInteger()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"unsignedInteger")," method creates an ",(0,l.kt)("inlineCode",{parentName:"p"},"UNSIGNED INTEGER")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.unsignedInteger("votes");\n')),(0,l.kt)("h4",{id:"column-method-unsignedMediumInteger"},(0,l.kt)("inlineCode",{parentName:"h4"},"unsignedMediumInteger()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"unsignedMediumInteger")," method creates an ",(0,l.kt)("inlineCode",{parentName:"p"},"UNSIGNED MEDIUMINT")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.unsignedMediumInteger("votes");\n')),(0,l.kt)("h4",{id:"column-method-unsignedSmallInteger"},(0,l.kt)("inlineCode",{parentName:"h4"},"unsignedSmallInteger()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"unsignedSmallInteger")," method creates an ",(0,l.kt)("inlineCode",{parentName:"p"},"UNSIGNED SMALLINT")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.unsignedSmallInteger("votes");\n')),(0,l.kt)("h4",{id:"column-method-unsignedTinyInteger"},(0,l.kt)("inlineCode",{parentName:"h4"},"unsignedTinyInteger()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"unsignedTinyInteger")," method creates an ",(0,l.kt)("inlineCode",{parentName:"p"},"UNSIGNED TINYINT")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.unsignedTinyInteger("votes");\n')),(0,l.kt)("h4",{id:"column-method-uuid"},(0,l.kt)("inlineCode",{parentName:"h4"},"uuid()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"uuid")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"UUID")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.uuid("id");\n')),(0,l.kt)("h4",{id:"column-method-year"},(0,l.kt)("inlineCode",{parentName:"h4"},"year()")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"year")," method creates a ",(0,l.kt)("inlineCode",{parentName:"p"},"YEAR")," equivalent column:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.year("birth_year");\n'))),(0,l.kt)("h3",{id:"column-modifiers"},"Column Modifiers"),(0,l.kt)("p",null,'In addition to the column types listed above, there are several column "modifiers" you may use when adding a column to a database table. For example, to make the column "nullable", you may use the ',(0,l.kt)("inlineCode",{parentName:"p"},"nullable")," method:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'#include <orm/schema.hpp>\n\nSchema::table("users", [](Blueprint &table)\n{\n    table.string("email").nullable();\n});\n')),(0,l.kt)("p",null,"The following table contains all of the available column modifiers. This list does not include ",(0,l.kt)("a",{parentName:"p",href:"#creating-indexes"},"index modifiers"),":"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Modifier"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},'.after("column")')),(0,l.kt)("td",{parentName:"tr",align:null},'Place the column "after" another column ',(0,l.kt)("small",null,"(MySQL)"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},".autoIncrement()")),(0,l.kt)("td",{parentName:"tr",align:null},"Set INTEGER columns as auto-incrementing (primary key).")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},'.charset("utf8mb4")')),(0,l.kt)("td",{parentName:"tr",align:null},"Specify a character set for the column ",(0,l.kt)("small",null,"(MySQL)"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("small",null,(0,l.kt)("inlineCode",{parentName:"td"},'.collation("utf8mb4_unicode_ci")'))),(0,l.kt)("td",{parentName:"tr",align:null},"Specify a collation for the column ",(0,l.kt)("small",null,"(MySQL/PostgreSQL/SQL Server)"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},'.comment("my comment")')),(0,l.kt)("td",{parentName:"tr",align:null},"Add a comment to a column ",(0,l.kt)("small",null,"(MySQL / PostgreSQL)"),".",(0,l.kt)("br",null),(0,l.kt)("small",null,"Special characters are escaped."))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},".defaultValue(value)")),(0,l.kt)("td",{parentName:"tr",align:null},'Specify a "default" value for the column.',(0,l.kt)("br",null),(0,l.kt)("small",null,"Special characters are escaped."))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},".first()")),(0,l.kt)("td",{parentName:"tr",align:null},'Place the column "first" in the table ',(0,l.kt)("small",null,"(MySQL)"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},".from(integer)")),(0,l.kt)("td",{parentName:"tr",align:null},"Set the starting value of an auto-incrementing field, an alias for ",(0,l.kt)("inlineCode",{parentName:"td"},"startingValue()")," ",(0,l.kt)("small",null,"(MySQL / PostgreSQL)"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},".invisible()")),(0,l.kt)("td",{parentName:"tr",align:null},'Make the column "invisible" to ',(0,l.kt)("inlineCode",{parentName:"td"},"SELECT *")," queries ",(0,l.kt)("small",null,"(MySQL)"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},".nullable(value = true)")),(0,l.kt)("td",{parentName:"tr",align:null},"Allow NULL values to be inserted into the column.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},".startingValue(integer)")),(0,l.kt)("td",{parentName:"tr",align:null},"Set the starting value of an auto-incrementing field ",(0,l.kt)("small",null,"(MySQL / PostgreSQL)"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},".storedAs(expression)")),(0,l.kt)("td",{parentName:"tr",align:null},"Create a stored generated column ",(0,l.kt)("small",null,"(MySQL / PostgreSQL)"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},".unsigned()")),(0,l.kt)("td",{parentName:"tr",align:null},"Set INTEGER columns as UNSIGNED ",(0,l.kt)("small",null,"(MySQL)"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},".useCurrent()")),(0,l.kt)("td",{parentName:"tr",align:null},"Set TIMESTAMP columns to use CURRENT_TIMESTAMP as default value.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},".useCurrentOnUpdate()")),(0,l.kt)("td",{parentName:"tr",align:null},"Set TIMESTAMP columns to use CURRENT_TIMESTAMP when a record is updated.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},".virtualAs(expression)")),(0,l.kt)("td",{parentName:"tr",align:null},"Create a virtual generated column ",(0,l.kt)("small",null,"(MySQL)"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},".generatedAs(expression)")),(0,l.kt)("td",{parentName:"tr",align:null},"Create an identity column with specified sequence options ",(0,l.kt)("small",null,"(PostgreSQL)"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},".always()")),(0,l.kt)("td",{parentName:"tr",align:null},"Defines the precedence of sequence values over input for an identity column ",(0,l.kt)("small",null,"(PostgreSQL)"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},".isGeometry()")),(0,l.kt)("td",{parentName:"tr",align:null},"Set spatial column type to ",(0,l.kt)("inlineCode",{parentName:"td"},"geometry")," - the default type is ",(0,l.kt)("inlineCode",{parentName:"td"},"geography")," ",(0,l.kt)("small",null,"(PostgreSQL)"),".")))),(0,l.kt)("h4",{id:"default-expressions"},"Default Expressions"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"defaultValue")," modifier accepts a value or an ",(0,l.kt)("inlineCode",{parentName:"p"},"Orm::Query::Expression")," instance. Using an ",(0,l.kt)("inlineCode",{parentName:"p"},"Expression")," instance will prevent TinyORM from wrapping the value in quotes and allow you to use database specific functions. One situation where this is particularly useful is when you need to assign default values to JSON columns:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'#include <orm/schema.hpp>\n\nusing Orm::Query::Expression;\n\nSchema::create("flights", [](Blueprint &table)\n{\n    table.id();\n    table.json("detail").defaultValue(Expression("(JSON_ARRAY(\'none\'))"));\n    table.timestamps();\n});\n')),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Support for default expressions depends on your database driver, database version, and the field type. Please refer to your database's documentation."))),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"You can obtain an ",(0,l.kt)("inlineCode",{parentName:"p"},"Orm::Query::Expression")," using the ",(0,l.kt)("a",{parentName:"p",href:"/database/query-builder#raw-expressions"},(0,l.kt)("inlineCode",{parentName:"a"},"DB::raw"))," method if you have access to the ",(0,l.kt)("inlineCode",{parentName:"p"},"DB")," facade."))),(0,l.kt)("h4",{id:"column-order"},"Column Order"),(0,l.kt)("p",null,"When using the MySQL database, the ",(0,l.kt)("inlineCode",{parentName:"p"},"after")," method may be used to add columns after an existing column in the schema:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.after("password", [](Blueprint &table)\n{\n    table.string("address_line1");\n    table.string("address_line2");\n    table.string("city");\n});\n')),(0,l.kt)("h3",{id:"modifying-columns"},"Modifying Columns"),(0,l.kt)("p",null,"Not implemented."),(0,l.kt)("h4",{id:"renaming-columns"},"Renaming Columns"),(0,l.kt)("p",null,"To rename a column, you may use the ",(0,l.kt)("inlineCode",{parentName:"p"},"renameColumn")," method provided by the schema builder blueprint:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'Schema::table("users", [](Blueprint &table)\n{\n    table.renameColumn("from", "to");\n});\n')),(0,l.kt)("h3",{id:"dropping-columns"},"Dropping Columns"),(0,l.kt)("p",null,"To drop a column, you may use the ",(0,l.kt)("inlineCode",{parentName:"p"},"dropColumn")," method on the schema builder blueprint:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'Schema::table("users", [](Blueprint &table)\n{\n    table.dropColumn("votes");\n});\n')),(0,l.kt)("p",null,"You may drop multiple columns from a table by passing a ",(0,l.kt)("inlineCode",{parentName:"p"},"QVector<QString>")," of column names to the ",(0,l.kt)("inlineCode",{parentName:"p"},"dropColumns")," method, the ",(0,l.kt)("inlineCode",{parentName:"p"},"dropColumns")," method also provides parameter pack overload:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'Schema::table("users", [](Blueprint &table)\n{\n    table.dropColumns({"votes", "avatar", "location"});\n    // Parameter pack overload\n    table.dropColumns("votes", "avatar", "location");\n});\n')),(0,l.kt)("h4",{id:"available-command-aliases"},"Available Command Aliases"),(0,l.kt)("p",null,"TinyORM provides several convenient methods related to dropping common types of columns. Each of these methods is described in the table below:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Command"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"table.dropRememberToken();")),(0,l.kt)("td",{parentName:"tr",align:null},"Drop the ",(0,l.kt)("inlineCode",{parentName:"td"},"remember_token")," column.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"table.dropTimestamps();")),(0,l.kt)("td",{parentName:"tr",align:null},"Drop the ",(0,l.kt)("inlineCode",{parentName:"td"},"created_at")," and ",(0,l.kt)("inlineCode",{parentName:"td"},"updated_at")," columns.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"table.dropTimestampsTz();")),(0,l.kt)("td",{parentName:"tr",align:null},"Alias of ",(0,l.kt)("inlineCode",{parentName:"td"},"dropTimestamps()")," method.")))),(0,l.kt)("h2",{id:"indexes"},"Indexes"),(0,l.kt)("h3",{id:"creating-indexes"},"Creating Indexes"),(0,l.kt)("p",null,"The TinyORM schema builder supports several types of indexes. The following example creates a new ",(0,l.kt)("inlineCode",{parentName:"p"},"email")," column and specifies that its values should be unique. To create the index, we can chain the ",(0,l.kt)("inlineCode",{parentName:"p"},"unique")," method onto the column definition:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'#include <orm/schema.hpp>\n\nSchema::table("users", [](Blueprint &table)\n{\n    table.string("email").unique();\n});\n')),(0,l.kt)("p",null,"Alternatively, you may create the index after defining the column. To do so, you should call the ",(0,l.kt)("inlineCode",{parentName:"p"},"unique")," method on the schema builder blueprint. This method accepts the name of the column that should receive a unique index:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.unique("email");\n')),(0,l.kt)("p",null,"You may even pass a ",(0,l.kt)("inlineCode",{parentName:"p"},"QVector<QString>")," of columns to an index method to create a compound (or composite) index:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.index({"account_id", "created_at"});\n')),(0,l.kt)("p",null,"When creating an index, TinyORM will automatically generate an index name based on the table, column names, and the index type (eg. users_email_unique), but you may pass a second argument to the method to specify the index name yourself:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.unique("email", "unique_email");\n')),(0,l.kt)("h4",{id:"available-index-types"},"Available Index Types"),(0,l.kt)("p",null,"TinyORM's schema builder blueprint class provides methods for creating each type of index supported by TinyORM. Each index method accepts an optional second argument to specify the name of the index. If omitted, the name will be derived from the names of the table and column(s) used for the index, as well as the index type (eg. users_email_fulltext). Each of the available index methods is described in the table below:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Command"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},'table.primary("id");')),(0,l.kt)("td",{parentName:"tr",align:null},"Adds a primary key.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},'table.primary({"id", "parent_id"});')),(0,l.kt)("td",{parentName:"tr",align:null},"Adds composite keys.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},'table.unique("email");')),(0,l.kt)("td",{parentName:"tr",align:null},"Adds a unique index.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},'table.index("state");')),(0,l.kt)("td",{parentName:"tr",align:null},"Adds an index.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},'table.fullText("body");')),(0,l.kt)("td",{parentName:"tr",align:null},"Adds a full text index (MySQL/PostgreSQL).")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("small",null,(0,l.kt)("inlineCode",{parentName:"td"},'table.fullText("body").language("english");'))),(0,l.kt)("td",{parentName:"tr",align:null},"Adds a full text index of the specified language (PostgreSQL).")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},'table.spatialIndex("location");')),(0,l.kt)("td",{parentName:"tr",align:null},"Adds a spatial index (except SQLite).")))),(0,l.kt)("h4",{id:"index-lengths--mysql--mariadb"},"Index Lengths & MySQL / MariaDB"),(0,l.kt)("p",null,"By default, TinyORM uses the ",(0,l.kt)("inlineCode",{parentName:"p"},"utf8mb4")," character set. If you are running a version of MySQL older than the 5.7.7 release or MariaDB older than the 10.2.2 release, you may need to manually configure the default string length generated by migrations in order for MySQL to create indexes for them. You may configure the default string length by calling the ",(0,l.kt)("inlineCode",{parentName:"p"},"Schema::defaultStringLength")," method:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"#include <orm/schema.hpp>\n\nSchema::defaultStringLength(191);\n")),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Alternatively, you may enable the ",(0,l.kt)("inlineCode",{parentName:"p"},"innodb_large_prefix")," option for your database (enabled by default in >=MySQL 5.7.7). Refer to your database's documentation for instructions on how to properly enable this option."))),(0,l.kt)("h3",{id:"renaming-indexes"},"Renaming Indexes"),(0,l.kt)("p",null,"To rename an index, you may use the ",(0,l.kt)("inlineCode",{parentName:"p"},"renameIndex")," method provided by the schema builder blueprint. This method accepts the current index name as its first argument and the desired name as its second argument:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.renameIndex("from", "to");\n')),(0,l.kt)("h3",{id:"dropping-indexes"},"Dropping Indexes"),(0,l.kt)("p",null,"To drop an index, you must specify the index's name. By default, TinyORM automatically assigns an index name based on the table name, the name of the indexed column, and the index type (eg. users_email_unique). Here are some examples:"),(0,l.kt)("div",{id:"apitable-dropping-indexes"},(0,l.kt)(o.Z,{mdxType:"APITable"},(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Command"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},'table.dropPrimary("users_id_primary");')),(0,l.kt)("td",{parentName:"tr",align:null},'Drop a primary key from the "users" table.')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},'table.dropUnique("users_email_unique");')),(0,l.kt)("td",{parentName:"tr",align:null},'Drop a unique index from the "users" table.')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},'table.dropIndex("geo_state_index");')),(0,l.kt)("td",{parentName:"tr",align:null},'Drop a basic index from the "geo" table.')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("small",null,(0,l.kt)("inlineCode",{parentName:"td"},'table.dropFullText("posts_body_fulltext");'))),(0,l.kt)("td",{parentName:"tr",align:null},'Drop a full text index from the "posts" table.')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("small",null,(0,l.kt)("inlineCode",{parentName:"td"},'.dropSpatialIndex("geo_location_spatialindex");'))),(0,l.kt)("td",{parentName:"tr",align:null},'Drop a spatial index from the "geo" table  (except SQLite).')))))),(0,l.kt)("p",null,"I may also drop indexes by a column name or column names for composite keys, if you pass a ",(0,l.kt)("inlineCode",{parentName:"p"},"QVector<QString>")," of columns into a method that drops indexes, the conventional index name will be generated based on the table name, columns, and index type:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'Schema::table("geo", [](Blueprint &table)\n{\n    table.dropIndex({"state"}); // Drops index \'geo_state_index\'\n});\n')),(0,l.kt)("h3",{id:"foreign-key-constraints"},"Foreign Key Constraints"),(0,l.kt)("p",null,"TinyORM also provides support for creating foreign key constraints, which are used to force referential integrity at the database level. For example, let's define a ",(0,l.kt)("inlineCode",{parentName:"p"},"user_id")," column on the ",(0,l.kt)("inlineCode",{parentName:"p"},"posts")," table that references the ",(0,l.kt)("inlineCode",{parentName:"p"},"id")," column on a ",(0,l.kt)("inlineCode",{parentName:"p"},"users")," table:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'#include <orm/schema.hpp>\n\nusing Orm::Constants::ID;\n\nSchema::table("posts", [](Blueprint &table)\n{\n    table.unsignedBigInteger("user_id");\n\n    table.foreign("user_id").references(ID).on("users");\n});\n')),(0,l.kt)("p",null,"Since this syntax is rather verbose, TinyORM provides additional, terser methods that use conventions to provide a better developer experience. When using the ",(0,l.kt)("inlineCode",{parentName:"p"},"foreignId")," method to create your column, the example above can be rewritten like so:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'Schema::table("posts", [](Blueprint &table)\n{\n    table.foreignId("user_id").constrained();\n});\n')),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"foreignId")," method creates an ",(0,l.kt)("inlineCode",{parentName:"p"},"UNSIGNED BIGINT")," equivalent column, while the ",(0,l.kt)("inlineCode",{parentName:"p"},"constrained")," method will use conventions to determine the table and column name being referenced. If your table name does not match TinyORM's conventions, you may specify the table name by passing it as an argument to the ",(0,l.kt)("inlineCode",{parentName:"p"},"constrained")," method:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'Schema::table("posts", [](Blueprint &table)\n{\n    table.foreignId("user_id").constrained("users");\n});\n')),(0,l.kt)("p",null,'You may also specify the desired action for the "on delete" and "on update" properties of the constraint:'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'#include <orm/constants.hpp>\n\nusing Orm::SchemaNs::Constants::Cascade;\n\ntable.foreignId("user_id")\n     .constrained()\n     .onUpdate("cascade")\n     .onDelete(Cascade);\n')),(0,l.kt)("p",null,"An alternative, expressive syntax is also provided for these actions:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Method"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"table.cascadeOnUpdate();")),(0,l.kt)("td",{parentName:"tr",align:null},"Updates should cascade.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"table.restrictOnUpdate();")),(0,l.kt)("td",{parentName:"tr",align:null},"Updates should be restricted.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"table.cascadeOnDelete();")),(0,l.kt)("td",{parentName:"tr",align:null},"Deletes should cascade.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"table.restrictOnDelete();")),(0,l.kt)("td",{parentName:"tr",align:null},"Deletes should be restricted.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"table.nullOnDelete();")),(0,l.kt)("td",{parentName:"tr",align:null},"Deletes should set the foreign key value to null.")))),(0,l.kt)("p",null,"Any additional ",(0,l.kt)("a",{parentName:"p",href:"#column-modifiers"},"column modifiers")," must be called before the ",(0,l.kt)("inlineCode",{parentName:"p"},"constrained")," method:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.foreignId("user_id")\n     .nullable()\n     .constrained();\n')),(0,l.kt)("h4",{id:"dropping-foreign-keys"},"Dropping Foreign Keys"),(0,l.kt)("p",null,"To drop a foreign key, you may use the ",(0,l.kt)("inlineCode",{parentName:"p"},"dropForeign"),' method, passing the name of the foreign key constraint to be deleted as an argument. Foreign key constraints use the same naming convention as indexes. In other words, the foreign key constraint name is based on the name of the table and the columns in the constraint, followed by a "_foreign" suffix:'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.dropForeign("posts_user_id_foreign");\n')),(0,l.kt)("p",null,"Alternatively, you may pass a ",(0,l.kt)("inlineCode",{parentName:"p"},"QVector<QString>")," containing the column name that holds the foreign key to the ",(0,l.kt)("inlineCode",{parentName:"p"},"dropForeign")," method. The ",(0,l.kt)("inlineCode",{parentName:"p"},"QVector")," will be converted to a foreign key constraint name using TinyORM's constraint naming conventions:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'table.dropForeign({"user_id"});\n')),(0,l.kt)("h4",{id:"toggling-foreign-key-constraints"},"Toggling Foreign Key Constraints"),(0,l.kt)("p",null,"You may enable or disable foreign key constraints within your migrations by using the following methods:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"Schema::enableForeignKeyConstraints();\n\nSchema::disableForeignKeyConstraints();\n")))}v.isMDXComponent=!0}}]);